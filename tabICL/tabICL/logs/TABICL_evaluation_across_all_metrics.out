==========================================
Extended TabICL Metrics Evaluation
Date:       Tue 25 Nov 14:08:29 CET 2025
Host:       atlas
Job ID:     79820
CPUs:       8
Memory:     32768 MB
GPU(s):     0
Python:     /vol/miltank/users/sajb/Project/tabicl_env/bin/python
Torch version: 2.9.1+cu128
CUDA available: True
==========================================

Starting extended evaluation (CoxPH, RSF, XGBoost, NFG, DeSurv)...
============================================================
EXTENDED EVALUATION: Raw vs Deep (Includes NFG/DeSurv)
============================================================

LOADING DATA: Mode RAW

Loaded METABRIC: 1904 samples, 9 features
Events: 1103 (57.9%), Censored: 801 (42.1%)
Split: Train=1332, Val=286, Test=286

--- Evaluating CoxPH ---
    Fitted in 0.4s
    IBS: 0.1877
    C-Index (Avg): 0.6064

--- Evaluating RSF ---
    Fitted in 2.2s
    IBS: 0.1819
    C-Index (Avg): 0.6874

--- Evaluating XGBoost ---
    Fitted in 0.3s
    IBS: 0.3700
    C-Index (Avg): 0.5888

--- Evaluating NeuralFineGray ---
    Fitted in 4.0s
    IBS: 0.5770
    C-Index (Avg): 0.5456

--- Evaluating DeSurv ---
    Fitted in 4.1s
    IBS: 0.6515
    C-Index (Avg): 0.5000

Saved to /vol/miltank/users/sajb/Project/NeuralFineGray/tabICL/results/extended/results_raw_140904.json

LOADING DATA: Mode DEEP

Loaded METABRIC: 1904 samples, 9 features
Events: 1103 (57.9%), Censored: 801 (42.1%)
Split: Train=1332, Val=286, Test=286

Applying TabICL embedding extraction (mode: deep)...
============================================================
Applying TabICL Embedding Extraction
============================================================

[1/4] Initializing TabICL...
  Training samples: 1332
  Features: 9

[2/4] Fitting TabICL on training data...
  ✓ TabICL fitted successfully
  Mode: Deep encoder embeddings
DEBUG: Extracted embeddings for split 'train' with shape torch.Size([1332, 512])
DEBUG: Extracted embeddings for split 'val' with shape torch.Size([286, 512])
DEBUG: Extracted embeddings for split 'test' with shape torch.Size([286, 512])

✓ Deep embeddings extracted: 512D

[4/4] Using embeddings only (no raw features)...
============================================================
TabICL Embedding Complete
Final Train Shape: (1332, 512)
============================================================


--- Evaluating CoxPH ---
    Fitted in 13.0s
    IBS: 0.1865
    C-Index (Avg): 0.6023

--- Evaluating RSF ---
    Fitted in 25.2s
    IBS: 0.1834
    C-Index (Avg): 0.6835

--- Evaluating XGBoost ---
    Fitted in 1.6s
    IBS: 0.4126
    C-Index (Avg): 0.5705

--- Evaluating NeuralFineGray ---
    Fitted in 7.3s
    IBS: 0.6334
    C-Index (Avg): 0.5255

--- Evaluating DeSurv ---
    Fitted in 5.7s
    IBS: 0.2130
    C-Index (Avg): 0.6956

Saved to /vol/miltank/users/sajb/Project/NeuralFineGray/tabICL/results/extended/results_deep_141011.json

LOADING DATA: Mode DEEP+RAW

Loaded METABRIC: 1904 samples, 9 features
Events: 1103 (57.9%), Censored: 801 (42.1%)
Split: Train=1332, Val=286, Test=286

Applying TabICL embedding extraction (mode: deep+raw)...
============================================================
Applying TabICL Embedding Extraction
============================================================

[1/4] Initializing TabICL...
  Training samples: 1332
  Features: 9

[2/4] Fitting TabICL on training data...
  ✓ TabICL fitted successfully
  Mode: Deep encoder embeddings
DEBUG: Extracted embeddings for split 'train' with shape torch.Size([1332, 512])
DEBUG: Extracted embeddings for split 'val' with shape torch.Size([286, 512])
DEBUG: Extracted embeddings for split 'test' with shape torch.Size([286, 512])

✓ Deep embeddings extracted: 512D

[4/4] Concatenating with original features...
============================================================
TabICL Embedding Complete
Final Train Shape: (1332, 521)
============================================================


--- Evaluating CoxPH ---
    Fitted in 13.4s
    IBS: 0.1864
    C-Index (Avg): 0.6017

--- Evaluating RSF ---
    Fitted in 25.0s
    IBS: 0.1841
    C-Index (Avg): 0.6719

--- Evaluating XGBoost ---
    Fitted in 1.7s
    IBS: 0.4133
    C-Index (Avg): 0.5808

--- Evaluating NeuralFineGray ---
    Fitted in 7.7s
    IBS: 0.6348
    C-Index (Avg): 0.5704

--- Evaluating DeSurv ---
    Fitted in 1.6s
    IBS: 0.2362
    C-Index (Avg): 0.6648

Saved to /vol/miltank/users/sajb/Project/NeuralFineGray/tabICL/results/extended/results_deep+raw_141115.json

============================================================
Model           Raw        Deep       Deep+Raw  
------------------------------------------------------------
CoxPH           0.6064     0.6023     0.6017
RSF             0.6874     0.6835     0.6719
XGBoost         0.5888     0.5705     0.5808
NeuralFineGray  0.5456     0.5255     0.5704
DeSurv          0.5000     0.6956     0.6648

==========================================
Extended evaluation finished successfully.
Completed at: Tue 25 Nov 14:11:16 CET 2025
==========================================
