==========================================
Running All Baseline Models on METABRIC
==========================================

1. Cox Proportional Hazards...
-------------------------------------------
Loading and preprocessing METABRIC dataset...
Training samples: 1523
Validation samples: 381
Features: 9
Time range (train): [0.10, 351.00]
Time range (val):   [0.00, 355.20]
Event rate (train): 57.91%
Event rate (val):   58.01%

Training Cox Proportional Hazards model...

Model Summary:
                      coef  exp(coef)             p
covariate                                          
MKI67             0.010895   1.010955  7.896713e-01
EGFR             -0.057347   0.944267  1.382166e-01
PGR               0.112424   1.118987  1.130113e-03
ERBB2             0.078495   1.081658  2.798761e-02
Hormone           0.090210   1.094404  1.835388e-02
Radiotherapy     -0.077590   0.925344  2.430953e-02
Chemotherapy      0.322002   1.379887  4.851938e-13
ER-positive       0.004729   1.004740  9.216996e-01
Age at diagnosis  0.573926   1.775222  5.574434e-39

Evaluating model...
Validation samples for IBS: 380/381 (99.7%)
Time grid range: [24.58, 192.15]
Max time (train): 351.00

==================================================
RESULTS
==================================================
C-index (train): 0.6384
C-index (val):   0.6282
IBS (val):       0.1872
==================================================

Note: C-index computed directly from risk scores
      IBS computed using NeuralFineGray metrics
      Validation IBS computed on samples with time < max(train time)

2. XGBoost Survival...
-------------------------------------------
Loading and preprocessing METABRIC dataset for sksurv...
Training samples: 1523
Validation samples: 381
Features: 9
Time range (train): [0.10, 351.00]
Time range (val):   [0.00, 355.20]
Event rate (train): 57.91%
Event rate (val):   58.01%

Training XGBoost Survival model...

Evaluating model...
C-index (train): 0.7377
C-index (val):   0.6125
Validation samples for IBS: 380/381 (99.7%)
Time grid range: [24.58, 192.15]
Max time (train): 351.00

==================================================
XGBOOST MODEL RESULTS
==================================================
C-index (train): 0.7377
C-index (val):   0.6125
IBS (val):       0.6044
==================================================

Note: C-index computed directly from risk scores
      IBS computed using NeuralFineGray metrics with survival curves
      Validation IBS computed on samples with time < max(train time)

3. DeepSurv (Neural Cox)...
-------------------------------------------
Loading and preprocessing METABRIC dataset...
Training samples: 1523
Validation samples: 381
Features: 9
Time range (train): [0.10, 351.00]
Time range (val):   [0.00, 355.20]
Event rate (train): 57.91%
Event rate (val):   58.01%

Training DeepSurv model...
Using device: cuda
Epoch 20/100, Loss: 3.3324
Epoch 40/100, Loss: 3.3109
Epoch 60/100, Loss: 3.3192
Epoch 80/100, Loss: 3.3127
Epoch 100/100, Loss: 3.2963

Evaluating model...
Validation samples for evaluation: 380/381 (99.7%)
Time grid range: [24.58, 192.15]
Max time (train): 351.00

==================================================
DEEPSURV MODEL RESULTS
==================================================
C-index (train): 0.6963
C-index (val):   0.6473
IBS (val):       0.1853
==================================================

Note: C-index and IBS computed using NeuralFineGray metrics
      for single event survival analysis (competing_risk=1)
      Validation metrics computed on samples with time < max(train time)

4. Random Survival Forest...
-------------------------------------------
Loading and preprocessing METABRIC dataset...
Training samples: 1523
Validation samples: 381
Features: 9
Time range (train): [0.10, 351.00]
Time range (val):   [0.00, 355.20]
Event rate (train): 57.91%
Event rate (val):   58.01%

Training Random Survival Forest model...
Training RSF with 200 trees...

Evaluating model...
Validation samples for evaluation: 380/381 (99.7%)
Time grid range: [24.58, 192.15]
Max time (train): 351.00

==================================================
RANDOM SURVIVAL FOREST RESULTS
==================================================
C-index (train): 0.7531
C-index (val):   0.6160
IBS (val):       0.1845
==================================================

Note: C-index and IBS computed using NeuralFineGray metrics
      for single event survival analysis (competing_risk=1)
      Validation metrics computed on samples with time < max(train time)

==========================================
All baselines completed!
==========================================
